---
title: "ETC5523 Assignment 2"
author: Travis Rutledge 
date: "2024-09-05"
format:
  html:
    toc: true
    toc_float: true
    toc_depth: 2
    number_sections: true
    theme: flatly
    highlight: tango
    bibliography: reference.bib
  pdf:
    toc: true
    toc_depth: 2
    number_sections: true
    highlight: tango
    latex_engine: pdflatex
    fig_caption: true
    bibliography: reference.bib
editor: 
  markdown: 
    wrap: sentence
latex_engine: pdflatex
---

```{r setup, include = TRUE, echo = FALSE, cache = FALSE}

# .qmd settings
knitr::opts_chunk$set(
  echo = TRUE,
  eval = TRUE,
  out.width = "70%",
  fig.width = 8, 
  fig.height = 6,
  fig.retina = 3)
```



```{r libraries, message = FALSE, echo=FALSE, warning=FALSE, eval=TRUE}
library(tidyverse)
library(readr)
library(hrbrthemes)
library(dplyr)
library(ggplot2)
library(here)
library(knitr) 
library(kableExtra)
```

```{r load_dataset, message = FALSE, echo=FALSE, warning=FALSE, eval=TRUE}
medals <- read_csv(here::here("data", "medals.csv"))
```

# EXECUTIVE SUMMARY
It is recommended to introduce a new way to measure a country's performance at the Olympic Games called Weighted Total Score, which gives a country 3 points for a winning a gold medal, 2 points for a silver, and 1 point for a bronze. The benefit of this measure is that it is inclusive of all medals won while still prioritising gold medal wins. A limitation of this measure is the potential difficulty in getting the public to adopt a new way of looking at Olympic performance. 


# INTRODUCTION TO THE PROBLEM 
The International Olympic Committee's (IOC) current approach to measuring a country's Olympic performance is tallying gold medals. Put simply, whichever country wins the most gold medals is determined to be the winner of the Olymipc games. While silver and bronze medals are recorded, they are not considered unless two countries are tied with gold medals.

It can be argued that there are two problems with the IOC's current approach to measuring Olympic performance:

1. In most cases, athletes who won silver and bronze medals do not have their medals counted towards their country. They might win a medal, but their achievement is not used to represent their country unless there is a tie of gold medals. The three values of the Olympics are excellence, respect, and friendship [source](https://olympics.com/ioc/olympic-values). Is the IOC appropriately measuring excellence and respecting athletes by ignoring silver and bronze medals in most circumstances.
2. Tallying gold medals and not other medals is not a comprehensive look at the performance of a country. A country may win dozens of silver and bronze medals and no gold medals, and they would be ranked as one of the weakest country's in the games. Some countries like the United States and their media outlets report all medals earned, as they view it important to tally both gold medals own and total medals won[source](https://www.theguardian.com/sport/article/2024/aug/10/paris-olympics-2024-how-does-medal-tally-work-order). But, this is not how the IOC tallies results.

Others have proposed another way to ranking countries performance at the Olympics. Researchers Robert C Duncan and Andrew Parece published their own ranking method in the Journal of Sports Analytics that accounts for a country's probability of winning a medal if populations were all the same across countries. This approach was dubbed the "Duncan-Parece model". Although this calculation is useful in addressing population, the downside is that it may be difficult for the public to both understand and trust a calculation that is based on probability and weighting.

# KEY RESULTS 
## Introduction of a new measure - Weighted Total Score 
The goal is to create a new measure of tallying Olympic results per country that accomplishes three things:

1. It is inclusive of all medals won 
2. It prioritises gold medals won
3. It is simple to understand by the public

My proposed calculation is called the Weighted Medal Score (coloquially dubbed "Olympic Points"). The calculation gives 3 points to gold medals, 2 points to silver medals, and 1 point to bronze medals and then totals the scores for each country. The final score for each country is not the total count of all medals. Instead, it's a weighted score showing how productive a country is in winning medals.

The benefits of this new calculation is that it _______.

The biggest risk or limtiation of this measure is that it requires the public to shift their previous understanding of tallying countries' performance from medals to points. The public may be confused at first as to what a point or score means, and they might assume that the score is simply a medal count. To address this risk, the Weighted Medal Score will be visualised alongside medal counts. That way, the public will have a better opportunity to learn what the calculation is, how it is measured, and they can still refer to the previous way to tally results by looking at the medal counts. 



## Figure 

```{r medal_tables, eval = TRUE}
medals_with_score <- medals %>%
  rename(Gold = G, Silver = S, Bronze = B) %>%
  mutate("Weighted Total Score" = (Gold * 3) + (Silver * 2) + (Bronze * 1))

medals_with_score_table <- medals_with_score %>%
  select(Country, "Weighted Total Score", Total, Gold, Silver, Bronze)
  
kable(medals_with_score_table, format = "html") %>%
kable_styling(font_size = 12) %>%
kable_styling(html_font = "Arial") 
```


```{r bar_charts, eval = FALSE}
gold_bar_chart <- medals_with_score %>%
  filter(G >10) %>%
  mutate(Country = factor(Country, levels = Country[order(G, decreasing = FALSE)])) %>%
  ggplot(aes(x = G, y = Country)) +
  geom_bar(stat = "identity") +
  geom_text(aes(label = Score),
            hjust = -.2,
            color = "gold",
            size = 3.5) +
  theme_minimal() +
  theme(panel.grid = element_blank(),
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.line.x = element_blank()) +
  labs(title = "China and the United States won the most gold medals at the 2024 Olympics")

bar_chart <- medals_with_score %>%
  filter(Score > 50) %>%
  mutate(Country = factor(Country, levels = Country[order(Score, decreasing = FALSE)])) %>%
  ggplot(aes(x = Score, y = Country)) + 
  geom_bar(stat = "identity") + 
  geom_text(aes(label = Score),
            hjust = -.2,
            color = "grey",
            size = 3.5) +
  theme_minimal() +
  theme(panel.grid = element_blank(),
        axis.title.x = element_blank(),
        axis.text.x = element_blank(),
        axis.ticks.x = element_blank(),
        axis.line.x = element_blank()) +
  labs(title = "The United States leads in the Medal Count Score",
       subtitle = "Gold medal = 3 points, silver medal = 2 points, bronze = 1 point")
```

```{r variable_names, messsage = FALSE, echo=FALSE, warning=FALSE, eval=FALSE}
#| label: tbl-1
#| tbl-cap: "Variable Names of the LGBTQ+ Dataset"
kable(data[25:30,])
```

# METHODS 
## Data Source 

## Data Dictionary 

# CONCLUSION 

